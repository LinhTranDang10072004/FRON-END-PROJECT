<div class="account-edit-page">
  <div class="edit-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <nav class="sidebar-nav">
        <a routerLink="/account" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
            <circle cx="12" cy="7" r="4"/>
          </svg>
          <span>Thông tin tài khoản</span>
        </a>
        <a routerLink="/account/wallet" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
            <line x1="1" y1="10" x2="23" y2="10"/>
          </svg>
          <span>Ví của tôi</span>
        </a>
        <a routerLink="/account/vat" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          <span>Thông tin xuất hóa đơn VAT</span>
        </a>
        <a routerLink="/account/orders" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 11l3 3L22 4"/>
            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
          </svg>
          <span>Đơn hàng đã mua</span>
        </a>
        <a routerLink="/account/activity" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
          </svg>
          <span>Nhật ký hoạt động</span>
        </a>
        <button class="nav-item logout-item" (click)="authService.logout()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
          <span>Đăng xuất</span>
        </button>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      @if (isLoading()) {
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <p>Đang tải thông tin...</p>
        </div>
      } @else {
        <!-- Success/Error Messages -->
        @if (successMessage()) {
          <div class="alert alert-success">
            {{ successMessage() }}
          </div>
        }
        @if (errorMessage()) {
          <div class="alert alert-error">
            {{ errorMessage() }}
          </div>
        }

        <!-- Account Info Form -->
        <div class="info-card">
          <div class="card-header">
            <h2 class="card-title">Tài khoản: {{ profile()?.username }}</h2>
            <button class="btn-update" (click)="updateProfile()" [disabled]="isSaving()">
              {{ isSaving() ? 'Đang cập nhật...' : 'Cập Nhật' }}
            </button>
          </div>

          <div class="form-content">
            <div class="form-group">
              <label class="form-label">Tên gian hàng</label>
              <input 
                type="text" 
                class="form-input"
                [ngModel]="shopName()"
                (ngModelChange)="shopName.set($event)"
                placeholder="Nhập tên gian hàng"
              />
              <p class="form-hint">Tên gian hàng sẽ hiển thị trên các sản phẩm của bạn</p>
            </div>

            <div class="form-group">
              <label class="form-label">Số điện thoại</label>
              <input 
                type="tel" 
                class="form-input"
                [ngModel]="phone()"
                (ngModelChange)="phone.set($event)"
                placeholder="Nhập số điện thoại"
              />
            </div>

            <div class="form-group">
              <label class="form-label">Email</label>
              <input 
                type="email" 
                class="form-input"
                [value]="email()"
                disabled
                placeholder="Email"
              />
              <p class="form-hint">Email không thể thay đổi</p>
            </div>

            <div class="form-group">
              <label class="form-label">Facebook</label>
              <input 
                type="url" 
                class="form-input"
                [ngModel]="facebookLink()"
                (ngModelChange)="facebookLink.set($event)"
                placeholder="https://www.facebook.com/your-profile"
              />
            </div>
          </div>
        </div>

        <!-- eKYC Section -->
        <div class="info-card">
          <div class="card-header">
            <h2 class="card-title">Định danh điện tử eKYC</h2>
          </div>

          <div class="ekyc-content">
            <div class="ekyc-grid">
              <div class="ekyc-item">
                <label class="ekyc-label">Ảnh căn cước mặt trước</label>
                <div class="image-upload">
                  @if (ekycFrontImage()) {
                    <img [src]="ekycFrontImage()!" alt="CCCD Front" class="preview-image" />
                  } @else {
                    <div class="image-placeholder">
                      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <circle cx="8.5" cy="8.5" r="1.5"/>
                        <polyline points="21 15 16 10 5 21"/>
                      </svg>
                    </div>
                  }
                  <input 
                    #frontInput
                    type="file" 
                    accept="image/*"
                    class="file-input"
                    (change)="onImageSelect($event, 'front')"
                  />
                  <button type="button" class="btn-select-image" (click)="frontInput.click()">Chọn Ảnh</button>
                </div>
              </div>

              <div class="ekyc-item">
                <label class="ekyc-label">Ảnh căn cước mặt sau</label>
                <div class="image-upload">
                  @if (ekycBackImage()) {
                    <img [src]="ekycBackImage()!" alt="CCCD Back" class="preview-image" />
                  } @else {
                    <div class="image-placeholder">
                      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <circle cx="8.5" cy="8.5" r="1.5"/>
                        <polyline points="21 15 16 10 5 21"/>
                      </svg>
                    </div>
                  }
                  <input 
                    #backInput
                    type="file" 
                    accept="image/*"
                    class="file-input"
                    (change)="onImageSelect($event, 'back')"
                  />
                  <button type="button" class="btn-select-image" (click)="backInput.click()">Chọn Ảnh</button>
                </div>
              </div>

              <div class="ekyc-item">
                <label class="ekyc-label">Ảnh chân dung</label>
                <div class="image-upload">
                  @if (ekycPortraitImage()) {
                    <img [src]="ekycPortraitImage()!" alt="Portrait" class="preview-image" />
                  } @else {
                    <div class="image-placeholder">
                      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <circle cx="8.5" cy="8.5" r="1.5"/>
                        <polyline points="21 15 16 10 5 21"/>
                      </svg>
                    </div>
                  }
                  <input 
                    #portraitInput
                    type="file" 
                    accept="image/*"
                    class="file-input"
                    (change)="onImageSelect($event, 'portrait')"
                  />
                  <button type="button" class="btn-select-image" (click)="portraitInput.click()">Chọn Ảnh</button>
                </div>
              </div>
            </div>

            <p class="ekyc-hint">(Vui lòng chọn ảnh rõ nét, không bị che mất)</p>

            <button class="btn-verify-ekyc" (click)="updateProfile()" [disabled]="isSaving()">
              Xác thực eKYC
            </button>
          </div>
        </div>

        <!-- Telegram Section -->
        <div class="info-card">
          <div class="card-header">
            <h2 class="card-title">Telegram: Kết nối và đầy tin</h2>
          </div>
          <div class="telegram-content">
            <div class="telegram-status">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
              </svg>
              <span>Tài khoản kết nối: {{ profile()?.username }}</span>
            </div>
            <button class="btn-disconnect-telegram">Ngưng kết nối Telegram</button>
          </div>
        </div>

        <!-- 2FA Section -->
        <div class="info-card">
          <div class="card-header">
            <h2 class="card-title">Bảo mật 2 lớp</h2>
          </div>
          <div class="twofa-content">
            <p class="twofa-description">
              Bật bảo mật hai lớp bằng code 2FA cho tài khoản của bạn. Mỗi khi đăng nhập hệ thống sẽ yêu cầu 1 mã 6 số được tạo từ chuỗi 2FA. Để phòng trường hợp bạn bị lộ pass hoặc lộ email
            </p>
            <button class="btn-enable-2fa">Bật</button>
          </div>
        </div>
      }
    </main>
  </div>
</div>

